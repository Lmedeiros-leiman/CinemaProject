@using CinemaProject.Data.Models;
@using CinemaProject.Data.Services;
@using CinemaProject.Components.MovieComponents;
@inject IMovieService MovieService


@using System.Text.Json;

<div class="container">
    <h2 class="text-center">Our current sessions</h2>
    <div class="row">
        @foreach (Movie movie in moviesWithSessions)
        {
            <section class="col card col-6 shadow-lg p-0 ">
               <picture>
                    <img width="100%" height="100%"  src="assets/@movie.PosterImage.URLPath" />
               </picture>
                <address class="mt-1 mb-0">
                    <h3 class="text-center">@movie.Title</h3>
                    <div class="text-black px-2">@movie.Description</div>
                    <p class="text-secondary px-2 " style="font-size: smaller ">
                        Released in 
                        @DateTime.FromBinary(movie.ReleaseDate).ToLongDateString().Split(",")[1]
                        
                        </p>
                <aside class="card m-2 border-2 p-1 shadow-sm">
                    @foreach (Session movieSession in movie.Sessions) {
                        <div class="row">
                            <div class="col">
                                @movieSession.SessionDate
                                <span> @movieSession.SessionTime</span>
                            </div>
                            <div class="col">
                                @(movieSession.SessionPrice),00 R$
                            </div>
                        </div>
                    }
                </aside>
                </address>
                    
                
            </section>
        }
        <div/>
    </div>
</div>



@code {



    List<Movie> moviesWithSessions = [];
    protected override async Task OnInitializedAsync()
    {
        moviesWithSessions = await MovieService.GetMoviesWithSessions();

    }


}

